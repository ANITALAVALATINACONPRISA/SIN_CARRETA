digraph DeploymentMonitoring {
    graph [bgcolor="#0a0e27", fontname="JetBrains Mono", fontsize=12, rankdir=TB, splines=ortho, pad=0.5, nodesep=0.8, ranksep=1.2];
    node [fontname="JetBrains Mono", fontsize=10, style="filled,rounded", shape=box, margin=0.3];
    edge [fontname="JetBrains Mono", fontsize=9, arrowsize=0.8];

    // Title
    label=<
        <table border="0" cellborder="0" cellspacing="0">
            <tr><td><font point-size="24" color="#00ffff"><b>üöÄ DEPLOYMENT &amp; MONITORING</b></font></td></tr>
            <tr><td><font point-size="12" color="#00d4ff">Canary Deployment with OpenTelemetry Tracing and SLO Monitoring</font></td></tr>
        </table>
    >;
    labelloc="t";

    // Traffic Source
    traffic [label="üåê Incoming\nTraffic", shape=ellipse, fillcolor="#ff00ff", color="#ff00ff", fontcolor="#000000", penwidth=3, style="filled"];

    // Traffic Router
    router [label=<
        <table border="0" cellborder="1" cellspacing="0" cellpadding="10" bgcolor="#1a2540" color="#00ff88">
            <tr><td bgcolor="#00ff88"><font color="#000000"><b>üîÄ TRAFFIC ROUTER</b></font></td></tr>
            <tr><td align="left"><font color="#ffffff"><b>Progressive Rollout</b></font></td></tr>
            <tr><td align="left"><font color="#ffff00">Stage 1: 5% canary</font></td></tr>
            <tr><td align="left"><font color="#ffff00">Stage 2: 25% canary</font></td></tr>
            <tr><td align="left"><font color="#ffff00">Stage 3: 100% canary</font></td></tr>
            <tr><td align="left"><font color="#00ffff"><b>Decision:</b> Real-time metrics</font></td></tr>
        </table>
    >, fillcolor="#1a2540", color="#00ff88", penwidth=3];

    // Baseline
    baseline [label=<
        <table border="0" cellborder="1" cellspacing="0" cellpadding="8" bgcolor="#1a1f3a" color="#00ffff">
            <tr><td bgcolor="#00ffff"><font color="#000000"><b>üì¶ BASELINE v1.0</b></font></td></tr>
            <tr><td align="left"><font color="#ffffff">Current Production</font></td></tr>
            <tr><td align="left"><font color="#ffff00">‚Ä¢ Stable metrics</font></td></tr>
            <tr><td align="left"><font color="#ffff00">‚Ä¢ Known behavior</font></td></tr>
        </table>
    >, fillcolor="#1a1f3a", color="#00ffff", penwidth=2];

    // Canary
    canary [label=<
        <table border="0" cellborder="1" cellspacing="0" cellpadding="8" bgcolor="#1a2f3a" color="#ffff00">
            <tr><td bgcolor="#ffff00"><font color="#000000"><b>üê§ CANARY v2.0</b></font></td></tr>
            <tr><td align="left"><font color="#ffffff">New Deployment</font></td></tr>
            <tr><td align="left"><font color="#ffff00">‚Ä¢ Under evaluation</font></td></tr>
            <tr><td align="left"><font color="#ffff00">‚Ä¢ Gradual traffic increase</font></td></tr>
        </table>
    >, fillcolor="#1a2f3a", color="#ffff00", penwidth=2];

    // OpenTelemetry
    tracing [label=<
        <table border="0" cellborder="1" cellspacing="0" cellpadding="10" bgcolor="#1a3050" color="#ff00ff">
            <tr><td bgcolor="#ff00ff"><font color="#000000"><b>üìä OPENTELEMETRY TRACING</b></font></td></tr>
            <tr><td align="left"><font color="#ffffff"><b>Distributed Tracing</b></font></td></tr>
            <tr><td align="left"><font color="#ffff00">‚ñ∏ 28 critical flows</font></td></tr>
            <tr><td align="left"><font color="#ffff00">‚ñ∏ 11 pipeline components</font></td></tr>
            <tr><td align="left"><font color="#ffff00">‚ñ∏ Trace ID correlation</font></td></tr>
            <tr><td align="left"><font color="#ffff00">‚ñ∏ Span context propagation</font></td></tr>
            <tr><td align="left"><font color="#00ffff"><b>Integration:</b> Phase 0 logging</font></td></tr>
        </table>
    >, fillcolor="#1a3050", color="#ff00ff", penwidth=3];

    // Metrics Collector
    metrics [label=<
        <table border="0" cellborder="1" cellspacing="0" cellpadding="10" bgcolor="#1a2050" color="#00d4ff">
            <tr><td bgcolor="#00d4ff"><font color="#000000"><b>üìà METRICS COLLECTOR</b></font></td></tr>
            <tr><td align="left"><font color="#ffffff"><b>Real-time Aggregation</b></font></td></tr>
            <tr><td align="left"><font color="#ffff00">‚ñ∏ Error rate</font></td></tr>
            <tr><td align="left"><font color="#ffff00">‚ñ∏ P95 latency</font></td></tr>
            <tr><td align="left"><font color="#ffff00">‚ñ∏ Availability</font></td></tr>
            <tr><td align="left"><font color="#ffff00">‚ñ∏ Contract violations</font></td></tr>
            <tr><td align="left"><font color="#00ffff"><b>Window:</b> 1min rolling</font></td></tr>
        </table>
    >, fillcolor="#1a2050", color="#00d4ff", penwidth=2];

    // SLO Monitor
    slo [label=<
        <table border="0" cellborder="1" cellspacing="0" cellpadding="10" bgcolor="#1a3040" color="#ffff00">
            <tr><td bgcolor="#ffff00"><font color="#000000"><b>üéØ SLO MONITOR</b></font></td></tr>
            <tr><td align="left"><font color="#ffffff"><b>Threshold Validation</b></font></td></tr>
            <tr><td align="left"><font color="#ff00ff">‚úì Availability: 99.5%</font></td></tr>
            <tr><td align="left"><font color="#ff00ff">‚úì P95 Latency: 200ms</font></td></tr>
            <tr><td align="left"><font color="#ff00ff">‚úì Error Rate: 0.1%</font></td></tr>
            <tr><td align="left"><font color="#ff00ff">‚úì Regression: 10%</font></td></tr>
            <tr><td align="left"><font color="#ff00ff">‚úì Recovery: 1.5s p99</font></td></tr>
        </table>
    >, fillcolor="#1a3040", color="#ffff00", penwidth=3];

    // Decision Engine
    decision [label=<
        <table border="0" cellborder="1" cellspacing="0" cellpadding="10" bgcolor="#1a1f40" color="#00ff88">
            <tr><td bgcolor="#00ff88"><font color="#000000"><b>üß† DECISION ENGINE</b></font></td></tr>
            <tr><td align="left"><font color="#ffffff"><b>Automated Control</b></font></td></tr>
            <tr><td align="left"><font color="#ffff00">Evaluate SLO compliance</font></td></tr>
            <tr><td align="left"><font color="#ffff00">Compare baseline vs canary</font></td></tr>
            <tr><td align="left"><font color="#ffff00">Trigger rollback or proceed</font></td></tr>
            <tr><td align="left"><font color="#00ffff"><b>Action:</b> Increase/Rollback</font></td></tr>
        </table>
    >, fillcolor="#1a1f40", color="#00ff88", penwidth=3];

    // Outcomes
    promote [label="‚úÖ PROMOTE\nCanary ‚Üí 100%", shape=octagon, fillcolor="#00ff88", color="#00ff88", fontcolor="#000000", penwidth=3, style="filled"];
    rollback [label="‚ö†Ô∏è ROLLBACK\nto Baseline", shape=octagon, fillcolor="#ff0000", color="#ff0000", fontcolor="#ffffff", penwidth=3, style="filled"];

    // Alerting
    alerts [label=<
        <table border="0" cellborder="1" cellspacing="0" cellpadding="8" bgcolor="#1a1a30" color="#ff00ff">
            <tr><td bgcolor="#ff00ff"><font color="#000000"><b>üö® ALERTING</b></font></td></tr>
            <tr><td align="left"><font color="#ffffff">Contract Violations</font></td></tr>
            <tr><td align="left"><font color="#ffffff">Performance Regressions</font></td></tr>
            <tr><td align="left"><font color="#ffffff">Fault Recovery Issues</font></td></tr>
        </table>
    >, fillcolor="#1a1a30", color="#ff00ff", penwidth=2];

    // Flow
    traffic -> router [label="100%", color="#ff00ff", fontcolor="#ff00ff", penwidth=3, style="bold"];
    router -> baseline [label="95%‚Üí75%‚Üí0%", color="#00ffff", fontcolor="#00ffff", penwidth=2];
    router -> canary [label="5%‚Üí25%‚Üí100%", color="#ffff00", fontcolor="#ffff00", penwidth=3, style="bold"];

    baseline -> tracing [label="Trace", color="#ff00ff", fontcolor="#ff00ff", penwidth=1.5, style="dashed"];
    canary -> tracing [label="Trace", color="#ff00ff", fontcolor="#ff00ff", penwidth=1.5, style="dashed"];

    baseline -> metrics [label="Emit", color="#00d4ff", fontcolor="#00d4ff", penwidth=2];
    canary -> metrics [label="Emit", color="#00d4ff", fontcolor="#00d4ff", penwidth=2];

    metrics -> slo [label="Aggregate", color="#ffff00", fontcolor="#ffff00", penwidth=2];
    tracing -> slo [label="Correlate", color="#ff00ff", fontcolor="#ff00ff", penwidth=1.5, style="dashed"];

    slo -> decision [label="SLO Data", color="#00ff88", fontcolor="#00ff88", penwidth=3, style="bold"];

    decision -> router [label="Adjust Traffic", color="#00ff88", fontcolor="#00ff88", penwidth=2, style="dashed", constraint=false];
    decision -> promote [label="SLO Met", color="#00ff88", fontcolor="#00ff88", penwidth=3, style="bold"];
    decision -> rollback [label="SLO Violated", color="#ff0000", fontcolor="#ff0000", penwidth=3, style="bold"];

    decision -> alerts [label="Trigger", color="#ff00ff", fontcolor="#ff00ff", penwidth=2, style="dashed"];
}
